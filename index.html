<!DOCTYPE html>
<html>
<head>
<title>Criptomoedas em Tempo Real</title>
<style>
body {
  font-family: sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f0f0f0;
}

#container {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

#crypto-selector {
  display: flex;
  margin-bottom: 20px;
}

.crypto-button {
  padding: 10px 20px;
  border: none;
  cursor: pointer;
}

#bitcoin-button {
  background-color: gold;
}

#ethereum-button {
  background-color: #8a8a8a; /* Melhor contraste */
}

#solana-button {
  background-color: purple;
}

#crypto-info {
  display: flex;
  flex-direction: column;
  align-items: center;
}

#price {
  font-size: 2em;
  margin-bottom: 10px;
}

#chart {
  width: 100%;
  max-width: 800px; /* Responsividade */
}
</style>
</head>
<body>
<div id="container">
  <h1>Criptomoedas em Tempo Real</h1>

  <div id="crypto-selector">
    <button class="crypto-button" id="bitcoin-button">Bitcoin</button>
    <button class="crypto-button" id="ethereum-button">Ethereum</button>
    <button class="crypto-button" id="solana-button">Solana</button>
  </div>

  <div id="crypto-info">
    <h2 id="crypto-name">Bitcoin</h2>
    <p id="price">Carregando...</p>
    <canvas id="chart"></canvas> <!-- Gráfico -->
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Seletores
const bitcoinButton = document.getElementById('bitcoin-button');
const ethereumButton = document.getElementById('ethereum-button');
const solanaButton = document.getElementById('solana-button');
const cryptoName = document.getElementById('crypto-name');
const price = document.getElementById('price');
const chartCanvas = document.getElementById('chart');

let currentCrypto = 'bitcoin';
let chartInstance = null;

// Dados para o gráfico
let timeLabels = [];
let priceData = [];

// Atualiza informações da criptomoeda
function updateCryptoInfo(crypto) {
    currentCrypto = crypto;

    // Atualiza o nome da criptomoeda
    cryptoName.textContent = crypto.charAt(0).toUpperCase() + crypto.slice(1);

    // Limpa os dados do gráfico ao trocar de moeda
    timeLabels = [];
    priceData = [];

    // Atualiza o preço e o gráfico
    fetchCryptoData();
}

// Busca dados da API e atualiza o preço e gráfico
function fetchCryptoData() {
    fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${currentCrypto}&vs_currencies=usd`)
        .then(response => response.json())
        .then(data => {
            const currentPrice = data[currentCrypto].usd;

            // Atualiza o preço na interface
            price.textContent = `$${currentPrice}`;

            // Adiciona os dados ao gráfico
            const now = new Date();
            timeLabels.push(now.toLocaleTimeString());
            priceData.push(currentPrice);

            // Mantém no máximo os últimos 10 pontos no gráfico
            if (timeLabels.length > 10) {
                timeLabels.shift();
                priceData.shift();
            }

            renderChart();
        })
        .catch(() => {
            console.error('Erro ao buscar dados da API.');
        });
}

// Renderiza o gráfico com os dados mais recentes
function renderChart() {
    if (chartInstance) {
        chartInstance.destroy(); // Destroi o gráfico anterior
    }

    chartInstance = new Chart(chartCanvas, {
        type: 'line',
        data: {
            labels: timeLabels,
            datasets: [{
                label: `${currentCrypto.charAt(0).toUpperCase() + currentCrypto.slice(1)} Price (USD)`,
                data: priceData,
                borderColor: getCryptoColor(currentCrypto),
                borderWidth: 2,
                tension: 0.4,
                fill: false,
            }]
        },
        options: {
            scales: {
                x: { title: { display: true, text: 'Tempo' } },
                y: { title: { display: true, text: 'Preço (USD)' }, beginAtZero: false }
            },
            plugins: { legend: { display: true } }
        }
    });
}

// Retorna a cor da criptomoeda para o gráfico
function getCryptoColor(crypto) {
    switch (crypto) {
        case 'bitcoin': return 'gold';
        case 'ethereum': return '#8a8a8a';
        case 'solana': return 'purple';
        default: return 'blue';
    }
}

// Atualiza os dados a cada intervalo de tempo (10 segundos)
setInterval(fetchCryptoData, 10000);

// Eventos dos botões
bitcoinButton.addEventListener('click', () => updateCryptoInfo('bitcoin'));
ethereumButton.addEventListener('click', () => updateCryptoInfo('ethereum'));
solanaButton.addEventListener('click', () => updateCryptoInfo('solana'));

// Inicializa com Bitcoin
updateCryptoInfo(currentCrypto);
</script>
</body>
</html>
