<!DOCTYPE html>
<html>
<head>
<title>Criptomoedas</title>
<style>
body {
  font-family: sans-serif;
  margin: 0;
  padding: 0;
}

#container {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  background-color: #f0f0f0;
}

#crypto-selector {
  display: flex;
  margin-bottom: 20px;
}

.crypto-button {
  padding: 10px 20px;
  border: none;
  cursor: pointer;
}

#bitcoin-button {
  background-color: gold;
}

#ethereum-button {
  background-color: #8a8a8a; /* Melhor contraste para Ethereum */
}

#solana-button {
  background-color: purple;
}

#crypto-info {
  display: flex;
  flex-direction: column;
  align-items: center;
}

#price {
  font-size: 2em;
  margin-bottom: 10px;
}

#chart {
  width: 100%;
  max-width: 800px; /* Responsividade */
  height: auto; /* Ajusta a altura automaticamente */
}

#books {
  margin-top: 20px;
}

.book {
  display: flex;
  margin-bottom: 10px;
}

.book img {
  width: auto; /* Mantém proporção */
  height: auto; /* Mantém proporção */
}
</style>
</head>
<body>
<div id="container">
  <h1>Criptomoedas</h1>

  <div id="crypto-selector">
    <button class="crypto-button" id="bitcoin-button">Bitcoin</button>
    <button class="crypto-button" id="ethereum-button">Ethereum</button>
    <button class="crypto-button" id="solana-button">Solana</button>
  </div>

  <div id="crypto-info">
    <h2 id="crypto-name">Bitcoin</h2>
    <p id="price">Carregando...</p>
    <canvas id="chart"></canvas> <!-- Alterado para canvas -->
  </div>

  <div id="books">
    <h2>Livros sobre Criptomoedas</h2>
    <div class="book">
      <img src="https://m.media-amazon.com/images/I/515z7+uX5CL._SY346_.jpg" alt="Bitcoin Book">
      <div>
        <h3>Bitcoin: A Peer-to-Peer Electronic Cash System</h3>
        <a href="#">Comprar</a>
      </div>
    </div>
    <div class="book">
      <img src="https://m.media-amazon.com/images/I/419qF566+PL._SY346_.jpg" alt="Ethereum Book">
      <div>
        <h3>The Infinite Machine</h3>
        <a href="#">Comprar</a>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Seletores
const bitcoinButton = document.getElementById('bitcoin-button');
const ethereumButton = document.getElementById('ethereum-button');
const solanaButton = document.getElementById('solana-button');
const cryptoName = document.getElementById('crypto-name');
const price = document.getElementById('price');
const chartCanvas = document.getElementById('chart');

let currentCrypto = 'bitcoin';
let chartInstance = null;

// Atualiza informações da criptomoeda
function updateCryptoInfo(crypto) {
  currentCrypto = crypto;
  
  // Atualiza o nome da criptomoeda
  cryptoName.textContent = crypto.charAt(0).toUpperCase() + crypto.slice(1);

  // Fetch do preço
  fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${crypto}&vs_currencies=usd`)
    .then(response => response.json())
    .then(data => {
      price.textContent = `$${data[crypto].usd}`;
    })
    .catch(() => {
      price.textContent = 'Erro ao carregar preço';
    });

   // Fetch do gráfico
   fetch(`https://api.coingecko.com/api/v3/coins/${crypto}/market_chart?vs_currency=usd&days=30`)
     .then(response => response.json())
     .then(data => {
       const prices = data.prices.map(price => ({
         x: new Date(price[0]),
         y: price[1]
       }));

       renderChart(prices, getCryptoColor(crypto));
     })
     .catch(() => {
       console.error('Erro ao carregar dados do gráfico.');
     });
}

// Renderiza o gráfico
function renderChart(data, color) {
   if (chartInstance) {
     chartInstance.destroy(); // Destroi o gráfico anterior
   }

   chartInstance = new Chart(chartCanvas, {
     type: 'line',
     data: {
       datasets: [{
         data,
         borderColor: color,
         borderWidth: 2,
         tension: 0.4,
         fill: false
       }]
     },
     options: {
       scales: {
         x: { type: 'time', time: { unit: 'day' } },
         y: { beginAtZero: false }
       },
       plugins: { legend: { display: false } }
     }
   });
}

// Retorna a cor da criptomoeda
function getCryptoColor(crypto) {
   switch (crypto) {
     case 'bitcoin': return 'gold';
     case 'ethereum': return '#8a8a8a';
     case 'solana': return 'purple';
   }
}

// Eventos dos botões
bitcoinButton.addEventListener('click', () => updateCryptoInfo('bitcoin'));
ethereumButton.addEventListener('click', () => updateCryptoInfo('ethereum'));
solanaButton.addEventListener('click', () => updateCryptoInfo('solana'));

// Inicializa com Bitcoin
updateCryptoInfo(currentCrypto);
</script>
</body>
</html>
